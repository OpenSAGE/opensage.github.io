<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.1d2ed03f53ff3b4dac78.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Noto+Serif+TC|Source+Code+Pro);
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}*{box-sizing:border-box}body,html{display:flex;margin:0;min-height:100%;padding:0;width:100%}body{font-family:"Noto Serif TC",serif;font-size:16px;line-height:1.6}h1,h2{margin-top:1em}h2{margin-bottom:.5em}h1+h2,h2+ul{margin-top:0}#___gatsby,#___gatsby>div{display:flex;height:100%;width:100%}.page{max-width:100%}#main-content,.page{display:flex;flex-direction:column;flex-grow:1;width:100%}#main-content{flex-shrink:0;margin-bottom:40px;margin-left:auto;margin-right:auto;max-width:700px;padding-left:2em;padding-right:2em}.row{display:flex;flex-direction:row;flex-shrink:0}.row+.row{margin-top:16px}.width-50{flex-shrink:0;max-width:50%}.responsive-image{display:flex;flex-shrink:1;max-width:100%}.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-left:16px}@media screen and (max-width:450px){.row{flex-direction:column}.responsive-image,.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-left:0;margin-top:16px}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}footer{background:#000;color:#fff;font-size:12px}.footer__content{margin-left:auto;margin-right:auto;max-width:900px;padding:8px}.header__logo{background:url(/opensage-logo.png);background-position:50%;background-repeat:no-repeat;background-size:contain;height:100px;min-height:80px}.navbar{border-bottom:2px solid #000}.navbar__items{display:flex;flex-direction:row;justify-content:center;list-style:none;margin:0 auto 16px}.nav-item{display:inline-flex}.nav-item:not(last-child){margin-right:40px}.nav-item a{color:#000;text-decoration:none}.nav-item a:hover{text-decoration:underline}@media screen and (max-width:350px){.navbar__items{flex-direction:column}.nav-item{margin-left:0;margin-right:0}.nav-item:not(last-child){margin-bottom:8px}}.post-content img{max-width:100%}.post-content .gatsby-resp-image-wrapper,.post-content .video-responsive{margin-bottom:2em;margin-top:2em}.post-content h2>a,.post-content h3>a{color:initial;text-decoration:none}.post-content li>p{margin-bottom:8px;margin-top:2px}.post-content blockquote{border-left:4px solid #d3d3d3;margin-left:0;padding-left:1em}.post-content pre{background:#eee;color:#333;overflow-x:auto;padding:1em}.post-content pre code{font-size:.8rem;line-height:1.2}.post-content code,.post-content pre code{font-family:Source Code Pro,Menlo,Consolas,monospace}.post-content code{background:#eee;color:#333;padding:2px 4px}.post-metadata span{display:block}.post-metadata__author{font-weight:700}.post-content .video-responsive{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.post-content .video-responsive>iframe{height:100%;left:0;position:absolute;top:0;width:100%}.post-content .table-wrapper{border:1px solid #bdc1c4;max-width:100%;overflow-x:auto}.post-content table{border-collapse:collapse}.post-content table th{background-color:#f0f0f0;padding-left:1em;padding-right:1em;width:auto}.post-content table td,.post-content table th{border-bottom:1px solid #bdc1c4;border-right:1px solid #ccc;padding:.5rem;white-space:nowrap}</style><meta name="generator" content="Gatsby 3.14.3"/><title data-react-helmet="true">Roads? How boring! Part 2: Inspecting the map file - OpenSAGE</title><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" name="twitter:title" content="Roads? How boring! Part 2: Inspecting the map file - OpenSAGE blog"/><meta data-react-helmet="true" name="twitter:description" content="Part 2 of the series about rendering the roads in SAGE maps: Finding out how the roads are stored in the map files"/><meta data-react-helmet="true" name="twitter:image" content="https://opensage.github.io/main-menu-social.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:title" content="Roads? How boring! Part 2: Inspecting the map file - OpenSAGE blog"/><meta data-react-helmet="true" property="og:description" content="Part 2 of the series about rendering the roads in SAGE maps: Finding out how the roads are stored in the map files"/><meta data-react-helmet="true" property="og:url" content="https://opensage.github.io/blog/roads-how-boring-part-2-inspecting-the-map-file/"/><meta data-react-helmet="true" property="og:image" content="https://opensage.github.io/main-menu-social.jpg"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="article:published_time" content="2020-02-19T00:00:00.000Z"/><link as="script" rel="preload" href="/webpack-runtime-da80e4af2c7a62b87dee.js"/><link as="script" rel="preload" href="/framework-3ff8eac72944ada5b1d3.js"/><link as="script" rel="preload" href="/app-4c0eca78ab875c07fb76.js"/><link as="script" rel="preload" href="/146795efe668deebd307e23d1bee48404d46676b-61b9cf2c73f895e6907b.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-4e75ef5397eab02032db.js"/><link as="fetch" rel="preload" href="/page-data/blog/roads-how-boring-part-2-inspecting-the-map-file/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page"><header><a href="/"><div class="header__logo"></div></a><nav class="navbar"><ol class="navbar__items"><li class="nav-item"><a href="/">About</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="https://github.com/OpenSAGE/OpenSAGE">GitHub</a></li><li class="nav-item"><a href="https://discord.gg/G2FhZUT">Discord</a></li></ol></nav></header><div id="main-content"><h1>Roads? How boring! Part 2: Inspecting the map file</h1><div class="post-metadata"><span class="post-metadata__author">Daniel Sklenitzka</span><span class="post-metadata__date">19 February 2020</span></div><div class="post-content"><p>Figuring out how to render the roads correctly in OpenSAGE turned out to be a little more challenging than expected. This is the second post in a series describing the journey. In <a href="/blog/roads-how-boring-part-1-taking-stock">part 1</a> we created a test map with some roads and looked at the textures for the different road types.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2919e94633165ef5e2115130acef04cc/27524/connected_roads.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 88.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAD1klEQVQ4yx1RWW8TVxid39FKrSCxE7zM5jgbWUZO7Nnu3Llzt1mMszZQSmjZYxPBL+gDhPJQ1BCS8oB4aqVC/0BVqe8VFVDSOK4INRLKYqehKFI1+XQePp3zPZzzHeHXX35r/tPcev16s15v1BuNzUar1fp3f7/Vau3vt9vt9ocPHw4PD/87mvfv3x8cHLRarb29vXa7Lfy1vv7i+e/r6/VXrxobG3++fPnij2fPt7berK9v1OubjcbfW1tvNjbq795tN5tvd3Z2d3b2trd3d3f2ms23Qq06c/ECvXypUl2YvXatvHC1UqtOV6tTN298tnh9plabuXghPPcFrS5MXb0SS9drM7Xq9I3FmcXFWUEvJY1SB7ASECQtIwGspGV2QtDlgJgvaJ8Wx49bRhJYSWAnTKPTNhMQdAGrg2JJCHhf4KucKYGfo0SmWPFc0XMlShTOchTL2JMYjdUoyAdcjRkkIVcsh4NCwHsCrniuZFupI6SJJ/tcZVR2YZZgyaeKz9TQV32mYJS1zRPAygArFfi9AiGKh7KukwV22gEZANIYiZzKAVOwJyM3i1EWI5FgkRMRwR7LVB2QtsxuivOCT3soFgmWYrfxXdZnMsWiz5XQVxmRMcoimAaWWCr2j42NIneQU8WxUwHvEyjJcapQIhJPQqgHe3lOBwJ/AHs56MgxgOI6Q4WCVigMu07ehZLjxNYmK0MCgjLxRIZFCHKl0rBpjhrGiK6PmEZhrDA0MtynaX2a1q9pA8XiSdMc1XWtWByEIBMFfYLnqsSTGFYolpGbYURiVESucv50eGaaWbpo6F3QSQM75dgZjGSf5QKeA9YJn+UFDykozqkyInGqsriJLCP5+blofi5EUAH2CQRFx065MEtJXJLP1IArUdgvYKQgmHaclGV2uzANnbQLUyEfvjI/PTdJPFc1zW7bTEOQCZjKqHT0fIkzcbIyKCAkQltheBiCXoaHIl8LmXZpvnLz2tkzU9x1ZMNIIDdDPNl10iHPhVz1UJqSbDnqFXye/3za+/L0xKVz0wtfzV0+N3X1/Gzt4umzMyygms9Un8lR2FMO86Gfq0S9oa+Uo1zk5ycrJwWK+xnSJkJ96pReCUplXpqIrFNBiXoDnCpRkAuDHGeyzxVCMpSIAVfKUT7gSlxVaTwxMvKxNvLR+Pgnhn7MNjssM2EZCaN0zNITLuw29OOmfsy2OiFImMZxx05CJ4lgF/Uk4bt7t1bu31ldvbv6YGlt7ZuH3999uHZ3deXOyv3b95eXlpdvP4j3W/e+/frx4+Wfnzx6+tOjH39YW11Zevrk8f+uVJgLPPHw/gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Test map"
        title="Test map"
        src="/static/2919e94633165ef5e2115130acef04cc/0a47e/connected_roads.png"
        srcset="/static/2919e94633165ef5e2115130acef04cc/8a4e8/connected_roads.png 150w,
/static/2919e94633165ef5e2115130acef04cc/5a46d/connected_roads.png 300w,
/static/2919e94633165ef5e2115130acef04cc/0a47e/connected_roads.png 600w,
/static/2919e94633165ef5e2115130acef04cc/27524/connected_roads.png 646w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Now that we finished our road network, let's save the map and see how all this information is stored in the map file...or rather, how it's <em>not</em> stored. While we can observe the described behavior (close endpoints are merged to form connected roads and crossings) in World Builder, the map file doesn't really care about these connections. Roads are not stored as separate objects. Instead, there's simply a pair of map objects for each road segment (the same kind of objects that are used for trees, buildings, units, props, etc) with some flags.</p>
<p>For our map above, it looks like this:</p>
<table>
<thead>
<tr>
<th>ObjectType</th>
<th>X</th>
<th>Y</th>
<th>RoadType</th>
</tr>
</thead>
<tbody>
<tr>
<td>TwoLaneDarkDotted</td>
<td>191</td>
<td>412</td>
<td>Start</td>
</tr>
<tr>
<td>TwoLaneDarkDotted</td>
<td>346</td>
<td>410</td>
<td>End</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TwoLaneDarkDotted</td>
<td>450</td>
<td>407</td>
<td>Start</td>
</tr>
<tr>
<td>TwoLaneDarkDotted</td>
<td>346</td>
<td>410</td>
<td>End</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TwoLaneDarkDotted</td>
<td>471</td>
<td>540</td>
<td>Start</td>
</tr>
<tr>
<td>TwoLaneDarkDotted</td>
<td>346</td>
<td>410</td>
<td>End</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TwoLaneOld2</td>
<td>288</td>
<td>288</td>
<td>Start | TightCurve</td>
</tr>
<tr>
<td>TwoLaneOld2</td>
<td>182</td>
<td>289</td>
<td>End</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>TwoLaneOld2</td>
<td>288</td>
<td>288</td>
<td>Start | TightCurve</td>
</tr>
<tr>
<td>TwoLaneOld2</td>
<td>291</td>
<td>393</td>
<td>End</td>
</tr>
</tbody>
</table>
<p>The <code>RoadType</code> is a bit field that contains information about whether this is a start or end point and about the curve type (the default is <code>BroadCurve</code>, whereas <code>TightCurve</code> and <code>Angled</code> have their own bits).</p>
<p>So all we know are the start and end positions of all road segments, but there's no information about the connections of these segments. It appears that two segments of the same type are connected when they share one of their positions.
In order to correctly draw the different road textures (remember, there are different types of crossings), we need to create a data structure that can be reasoned about more easily. We'll do that in <a href="/blog/roads-how-boring-part-3-building-a-graph-data-structure">part 3</a>.</p></div></div><footer><div class="footer__content"><p>OpenSAGE is not associated with Electronic Arts or any other company. All trademarks are property of their respective owners. Screenshots of copyrighted works are only used for demonstration purposes.</p><p>© OpenSAGE <!-- -->2021</p></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/roads-how-boring-part-2-inspecting-the-map-file";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4d452037006af707f98e.js"],"app":["/app-4c0eca78ab875c07fb76.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d44c0a818ce890b8c614.js"],"component---src-pages-blog-js":[],"component---src-pages-index-js":["/component---src-pages-index-js-b712fcc8262034a481fa.js"],"component---src-templates-post-js":["/component---src-templates-post-js-4e75ef5397eab02032db.js"]};/*]]>*/</script><script src="/polyfill-4d452037006af707f98e.js" nomodule=""></script><script src="/component---src-templates-post-js-4e75ef5397eab02032db.js" async=""></script><script src="/146795efe668deebd307e23d1bee48404d46676b-61b9cf2c73f895e6907b.js" async=""></script><script src="/app-4c0eca78ab875c07fb76.js" async=""></script><script src="/framework-3ff8eac72944ada5b1d3.js" async=""></script><script src="/webpack-runtime-da80e4af2c7a62b87dee.js" async=""></script></body></html>