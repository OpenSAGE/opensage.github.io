<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.1d2ed03f53ff3b4dac78.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css?family=Noto+Serif+TC|Source+Code+Pro);
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}*{box-sizing:border-box}body,html{display:flex;margin:0;min-height:100%;padding:0;width:100%}body{font-family:"Noto Serif TC",serif;font-size:16px;line-height:1.6}h1,h2{margin-top:1em}h2{margin-bottom:.5em}h1+h2,h2+ul{margin-top:0}#___gatsby,#___gatsby>div{display:flex;height:100%;width:100%}.page{max-width:100%}#main-content,.page{display:flex;flex-direction:column;flex-grow:1;width:100%}#main-content{flex-shrink:0;margin-bottom:40px;margin-left:auto;margin-right:auto;max-width:700px;padding-left:2em;padding-right:2em}.row{display:flex;flex-direction:row;flex-shrink:0}.row+.row{margin-top:16px}.width-50{flex-shrink:0;max-width:50%}.responsive-image{display:flex;flex-shrink:1;max-width:100%}.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-left:16px}@media screen and (max-width:450px){.row{flex-direction:column}.responsive-image,.responsive-image+.responsive-image,.responsive-image-container+.responsive-image-container{margin-left:0;margin-top:16px}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}footer{background:#000;color:#fff;font-size:12px}.footer__content{margin-left:auto;margin-right:auto;max-width:900px;padding:8px}.header__logo{background:url(/opensage-logo.png);background-position:50%;background-repeat:no-repeat;background-size:contain;height:100px;min-height:80px}.navbar{border-bottom:2px solid #000}.navbar__items{display:flex;flex-direction:row;justify-content:center;list-style:none;margin:0 auto 16px}.nav-item{display:inline-flex}.nav-item:not(last-child){margin-right:40px}.nav-item a{color:#000;text-decoration:none}.nav-item a:hover{text-decoration:underline}@media screen and (max-width:350px){.navbar__items{flex-direction:column}.nav-item{margin-left:0;margin-right:0}.nav-item:not(last-child){margin-bottom:8px}}.post-content img{max-width:100%}.post-content .gatsby-resp-image-wrapper,.post-content .video-responsive{margin-bottom:2em;margin-top:2em}.post-content h2>a,.post-content h3>a{color:initial;text-decoration:none}.post-content li>p{margin-bottom:8px;margin-top:2px}.post-content blockquote{border-left:4px solid #d3d3d3;margin-left:0;padding-left:1em}.post-content pre{background:#eee;color:#333;overflow-x:auto;padding:1em}.post-content pre code{font-size:.8rem;line-height:1.2}.post-content code,.post-content pre code{font-family:Source Code Pro,Menlo,Consolas,monospace}.post-content code{background:#eee;color:#333;padding:2px 4px}.post-metadata span{display:block}.post-metadata__author{font-weight:700}.post-content .video-responsive{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.post-content .video-responsive>iframe{height:100%;left:0;position:absolute;top:0;width:100%}.post-content .table-wrapper{border:1px solid #bdc1c4;max-width:100%;overflow-x:auto}.post-content table{border-collapse:collapse}.post-content table th{background-color:#f0f0f0;padding-left:1em;padding-right:1em;width:auto}.post-content table td,.post-content table th{border-bottom:1px solid #bdc1c4;border-right:1px solid #ccc;padding:.5rem;white-space:nowrap}</style><meta name="generator" content="Gatsby 3.14.3"/><title data-react-helmet="true">Roads? How boring! Part 7: Rendering crossings - OpenSAGE</title><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" name="twitter:title" content="Roads? How boring! Part 7: Rendering crossings - OpenSAGE blog"/><meta data-react-helmet="true" name="twitter:description" content="Part 7 of the series about rendering the roads in SAGE maps: Rendering crossings"/><meta data-react-helmet="true" name="twitter:image" content="https://opensage.github.io/main-menu-social.jpg"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" property="og:title" content="Roads? How boring! Part 7: Rendering crossings - OpenSAGE blog"/><meta data-react-helmet="true" property="og:description" content="Part 7 of the series about rendering the roads in SAGE maps: Rendering crossings"/><meta data-react-helmet="true" property="og:url" content="https://opensage.github.io/blog/roads-how-boring-part-7-rendering-crossings/"/><meta data-react-helmet="true" property="og:image" content="https://opensage.github.io/main-menu-social.jpg"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="article:published_time" content="2020-04-04T00:00:00.000Z"/><link as="script" rel="preload" href="/webpack-runtime-da80e4af2c7a62b87dee.js"/><link as="script" rel="preload" href="/framework-3ff8eac72944ada5b1d3.js"/><link as="script" rel="preload" href="/app-4c0eca78ab875c07fb76.js"/><link as="script" rel="preload" href="/146795efe668deebd307e23d1bee48404d46676b-61b9cf2c73f895e6907b.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-4e75ef5397eab02032db.js"/><link as="fetch" rel="preload" href="/page-data/blog/roads-how-boring-part-7-rendering-crossings/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="page"><header><a href="/"><div class="header__logo"></div></a><nav class="navbar"><ol class="navbar__items"><li class="nav-item"><a href="/">About</a></li><li class="nav-item"><a href="/blog">Blog</a></li><li class="nav-item"><a href="https://github.com/OpenSAGE/OpenSAGE">GitHub</a></li><li class="nav-item"><a href="https://discord.gg/G2FhZUT">Discord</a></li></ol></nav></header><div id="main-content"><h1>Roads? How boring! Part 7: Rendering crossings</h1><div class="post-metadata"><span class="post-metadata__author">Daniel Sklenitzka</span><span class="post-metadata__date">04 April 2020</span></div><div class="post-content"><style type="text/css">
img[src*="helipad_texture.png"] {
  border: 1px solid darkgray;
}
</style>
<p>Figuring out how to render the roads correctly in OpenSAGE turned out to be a little more challenging than expected. This is the seventh post in a series describing the journey. After finding out when to render which crossing texture in the <a href="/blog/roads-how-boring-part-6-choosing-a-crossing-type">previous post</a>, we can now proceed to actually rendering them.</p>
<p>Consider the following screenshot of the same crossing with three different road types in wireframe mode:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a95bba0b2de56ce202312e56b5db7259/27524/wireframe_crossing.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 88.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADx0lEQVQ4yz2Sy28bVRSH55+ibRLH9owf47wcP2fuzJ37mnvvvGzHeSABAgR1HgWxgw1CyqIUVcmiSahANHVSdrDoCiQQhBC3NCa4UlFR2jRuEhWZBdJZHOno0+/o00/5/rv7vaNe769et3t4eNjtHna7jw77/f6Lkxf9/unp6enFxcWrV6/Oz8/Pzs5evuz3+6fPnj87Pj4+OXmuPOh0fvzh/t5v+/v7f3QO9vb2fv35p1+63aPf9w86nQcPHz7q/nl0cNB58uTvXu/x06f//D+93mNlebH5+fWPPvm41Xq/udiKFlu1laXmynLzw5X5a8tzS4vNd94O3npDtq423ns3+uDa/MrybOtqY2V5bqnVVBAcnZ8t1kKd4WFGRoWbFCzuklHijEBrCFpDBI0ynEBwBMEhhkYguMJIQrB4LcwpkuuRr3syEwU5T6RrwZg/2Mc5SxGsOTAhXF3yTCRyHKdccyKCehSO+zL7+nxFcVlG8nTo5WrBWOjrgZf1ZEoSDUGV4hTBKnZUyVMRnsK2QUFZWIVADJCZel5BMMmoxqnGiIpRgtMEMpK0mMNG3LZGgTFigxgh8cjNOWbZtYq2WRJOCqGYL8cHyZyqkmc8kZU8HQiNWzlQKDIzh50kQSojGsVqKNIeyAtYobYhaEEwtVHLKz7LzbHpJk1LOYClyHhEc80iqhYlShGkujTNaVr4uscLmJMGqgCPcC83U5tSZuXEvLAbvDB4G2sUa5wm62iCAsBoHqM4wZo7VxX1SZNXJiPfnPOLjQgHxVCOKaGvL4hCGCAmJyGIMaxhnqnPGtQxK7CESJrTFPUmvHDKRIaFKoxZ3LEhqdaivEJnSrxejUI3nCVuNM5gEgfjRFYrtlFFFpsxfZESvh4IIABiFjAdEy6UjVlaWygrVIyFzGqErv+moI0JgkcHhhzIbAx9DOoVITXfzVHOpGlFgFOfmGGx6pb9uqFwqNeFjDw7iKb9RlF4aojzyGbSQVROG7DE/OwMLnEobIZcQphbKpqTZTMrworCnaxvFmg1i0UCkaRkWmBUwHSVVLPMT0GZpVT13IykOWaVfViCOGYyFcCYJ3RF8CyEMYqSA1VOkrO0z/WA5gXJugMsFUj9v+alJdUESxOsEkflJBX6kwpy4hTHgTFkg2ELXHasYdN4zRMJaA0B4woAlxCMQWsIwRFgXoL24GqDEbN6mbO0sr62ur6+evOLz9Zurm7euvHtvdvtuxu77a3dna3d9pft9mb77uZOe2v7zq3t7Y17u7d32ptff7V24/qnd77Z+Bc9edlG9H0XOQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Three crossings in wireframe mode"
        title="Three crossings in wireframe mode"
        src="/static/a95bba0b2de56ce202312e56b5db7259/0a47e/wireframe_crossing.png"
        srcset="/static/a95bba0b2de56ce202312e56b5db7259/8a4e8/wireframe_crossing.png 150w,
/static/a95bba0b2de56ce202312e56b5db7259/5a46d/wireframe_crossing.png 300w,
/static/a95bba0b2de56ce202312e56b5db7259/0a47e/wireframe_crossing.png 600w,
/static/a95bba0b2de56ce202312e56b5db7259/27524/wireframe_crossing.png 646w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>In order to render a crossing, there are three things we need to figure out:</p>
<ul>
<li>The position and size of the rectangle in world coordinates where we want to render the texture</li>
<li>The coordinates of that rectangle in texture space</li>
<li>The end points of the adjacent road segments - it might not be obvious, but if you look closely at the rightmost road, you can see that the connected road segments sightly overlap the crossing texture (points G and H). It's best visible at point I that the adjacent road segment does not start at the edge of the crossing texture.</li>
</ul>
<p>Let's start with the first problem.</p>
<h2>World coordinates</h2>
<p>The size of the rectangle and its position relative to the crossing node position depends on the <code>RoadWidth</code> as well as the <code>RoadWidthInTexture</code>. Here are the definitions of the three road types shown above:</p>
<div class="gatsby-highlight" data-language="ini"><pre class="language-ini"><code class="language-ini">Road GravelRoad
  <span class="token key attr-name">Texture</span> <span class="token punctuation">=</span> <span class="token value attr-value">TRGravelRoad.tga</span>
  <span class="token key attr-name">RoadWidth</span> <span class="token punctuation">=</span> <span class="token value attr-value">33</span>
  <span class="token key attr-name">RoadWidthInTexture</span> <span class="token punctuation">=</span> <span class="token value attr-value">.95</span>
End

Road TwoLaneDarkDotted
  <span class="token key attr-name">Texture</span> <span class="token punctuation">=</span> <span class="token value attr-value">TRTwoLane6.tga</span>
  <span class="token key attr-name">RoadWidth</span> <span class="token punctuation">=</span> <span class="token value attr-value">35.0</span>
  <span class="token key attr-name">RoadWidthInTexture</span> <span class="token punctuation">=</span> <span class="token value attr-value">0.9</span>
End

Road FourLaneDark
  <span class="token key attr-name">Texture</span> <span class="token punctuation">=</span> <span class="token value attr-value">TRFourLane2.tga</span>
  <span class="token key attr-name">RoadWidth</span> <span class="token punctuation">=</span> <span class="token value attr-value">60.0</span>
  <span class="token key attr-name">RoadWidthInTexture</span> <span class="token punctuation">=</span> <span class="token value attr-value">0.9</span>
End</code></pre></div>
<p>The larger <code>RoadWidth</code> and <code>RoadWidthInTexture</code> (remember, they are multiplied together), the larger the rectangle is going to be. By experimenting with different road types and measuring their sizes (<a href="/blog/roads-how-boring-part-4-rendering-straight-roads">like we did</a> for straight roads), it should be possible to find formulas for calculating them. But wait...there are some road types with a <code>RoadWidthInTexture</code> of 3:</p>
<div class="gatsby-highlight" data-language="ini"><pre class="language-ini"><code class="language-ini">Road Helipad
  <span class="token key attr-name">Texture</span> <span class="token punctuation">=</span> <span class="token value attr-value">TRHelipad.tga</span>
  <span class="token key attr-name">RoadWidth</span> <span class="token punctuation">=</span> <span class="token value attr-value">15</span>
  <span class="token key attr-name">RoadWidthInTexture</span> <span class="token punctuation">=</span> <span class="token value attr-value">3</span>
End</code></pre></div>
<p>What's that supposed to mean? Several things are strange in the texture:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 256px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/04ca28742f1bc65e05616f0fa58644e8/6f3f2/helipad_texture.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADhElEQVQ4y82QXUybZRTH/6wV9MLpSExc8IPo6C4Wo9MthjmGI27rB8NlTpTCFpayLKDGLeWzI5URTWQ6lMgEpR/AmAo4NmGUDMcopd+FF0r7lpa2tICyFTMRLmbk4j2muiwWzYzOC0/ye57n/C9+ec5B1dV675fDxV0qg/KbRn1JW6Ne3tpkKD135upxjWq44uvP9MrO5sHikSqjthgXKeW+vpvPQUebY+imLXDSBtSQHO2mij4ixBUtElbcF5+9OT/5dsQ/dmIxzBTSwrF1ZyatYHu3HF1iXpJ+MHQKOE+AjovFS8AnBFSQBJ8Pv3s5+RLBGZqXuf3B99kZf7pjYiDNMu4s9U0He68RrR3oeeGQb+xQAdkeQyHTHg8nx4vhHBcPGQFKOgDtUEk7eb9NvzF/rfbS+KeYKMf6iDm9aNBzFm79wL6F2Z9q2e6nc390ZB5s85YBRH9NKwHllIVKw+ke3Zyvvi4SOZgf/nBbI6NQXpg43lU9q355j0v9vNo9q2phTjWo/cq3QJS4bmXpCRA9HsMSRbNEfExH0PRVSYd1xtXwhd8t7La+WnDZnNugt+f19NpklafNR7d1uSKV/baTqkFPQT6I4p78eS4RRA/EEKRoxsMe2otO9eGmMKsvuz7zndzk1OCKZutmj3F/TY+pBNdVdff7vfO1bL/kzRujklwdW/j7eBwXSzSTEpBEO6DVHOuYcr6x3mK19c19P5ela09OYoa2pjIez71Tflf97ALt1F94ShoYlcrCpl3oHz/C+9P+hBwPjxCwkTKgUcs7FNV12J238uCYM/RRILxc5Q3TYX9oUenyLKd67EW4cn6X1GfLzncbJXAbJTysLgGtgYCi9050dxZZFqYkOVMOcWbAsiOLtcvLfcyJkyEmRxp0pIpnxg6InAaRyufIznebxWAtfyN8r6ZaNj26PXtUn5XnNYulrCFtv8eQum/SuPt1l3FvHmsU5rAmYc6k9ZWHxw1CTAyLcEchQA81qSrxg3c7QiMiBO0ZCNnTMT0igs+RiYBDgsCIGH7mNXhsEnjtkjsL1z6zvAEglL6juqetuYLfolXwz2oV/LZmBb9Zq+C3RvuWMn5hadcaJBASNv0SBwGthndLmBE9Hv2tSeFwK/znpNx+vwgIuDQIKBkCEkBAKf8ObiMElAQBZUetCf8h8X/4+l2MfHt0DncvWb3L/339CsHCdYjMFGlVAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Helipad texture"
        title="Helipad texture"
        src="/static/04ca28742f1bc65e05616f0fa58644e8/6f3f2/helipad_texture.png"
        srcset="/static/04ca28742f1bc65e05616f0fa58644e8/8a4e8/helipad_texture.png 150w,
/static/04ca28742f1bc65e05616f0fa58644e8/6f3f2/helipad_texture.png 256w"
        sizes="(max-width: 256px) 100vw, 256px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<ul>
<li>There are no different textures for the various road types, just a single one.</li>
<li>By default, the straight road texture takes up the top 25% of the whole image (light blue rectangle), but because the <code>RoadWidthInTexture</code> is so large, it now takes up a much bigger portion (dark blue rectangle).</li>
<li>They look utterly broken when we try to create crossings:</li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0d191572399573e488caeb1e1f171321/27524/wireframe_helipad.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 88.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADq0lEQVQ4yyXTWU8bZxQG4PlVXdLWtWc8yzfz7cvMfDNeAC+YzYAxFAqJ0pv8hLQyAZykqiI1Squm7X9oL3rRiwrRFBPCUrhAKRfgCIMqh6P39tWRzqNj/P7bHyf/npyenB4dHR4eHB0eHB6+Oej3+5cXl+/e9fuX/cHg+ubmZjAYXF9fDwaDq6ury4uLy4uLfr9vvN7b3d7+c3e398+r/b3ezt+vdv7a3jk+Pu7t9vZ6r/f33xwdH/d6e2dnZycnp2/f/nc75+fnJ6enxr219tJCfXlpbmWptbg4tdxsfDU7udCeWVtura207q62F1tT883xe6vt1ZX5u18urK20vmg3h1mcNTjOS5oX2Ay8DHE+qoAPKtkPVf5OADLE/5zBnMCWIJakeUVtji0Kc4H7mZf/WDHXSGOsla+4FxK7nVitGTVbCsaZU+WeDmExRoUYxRJo6Wvlh9yLJQi5x4ldiImhVaCoQ7HdlNn5cTkxThcbsh7aJQ5q1E4jmEYwEp5WfiyBoA7HeUFsQexyyoxI+hH3Qg5K3GkXweyEalRpndo6QiXm1plbjFAovEgAxV2G87chQa6o6XCzpI6ijqBukTlNZWoFytSrR97YqD+qvDrzIuYKbFNoYd+kyKLIQiAbS2gUYiypI4jNkSWYq5k7FlgFlp8rgumanKrh0ogKJzRhNgZZ7Ocosgg0IcjGChpFTULuCuII6oTcCyWIqFulmfua3x/VjdkGq0ZweSSYdjE2iT9s4sDEQU6H0ChoHAlPMkdQWzE34h7nzijFDwrowRidmauiaYlCh2hTlrOQZZCbo9BiyBqWiwkZGghPEFsSO5RuidLphE/UyHQZVFtkSuiUQl136mWSjjtUmQLbHOfTGBu3jJEAkjqMWilHNaoS4U+mfKGcjBZwFUUVEdTmcKXsT1Z51DBJYGE/l4TQGBowV0ufYiuGoM11hZIEoBiAmOdTG/HYxVGuWHEnG6TSBFxaNLCQn01CZGgFE+UXYxQrkJJgXhTHR6BgWR9mtBckwRBSJC5pOLqRD1ObQ1tSm0JzeO1CjNMwKMQoCYMoBIq4U0KOaZAEMPWR4I6irmZ+OOaLAoioL9h7FO4WE2pEwmPIZMjE79+AwCwPzBGfJB4Azh3oZWiQpTBHQdbPfxJ4n2I/w2COITPkrvGku/H08cZ333a7G50njze6m+vdrc7TrUdbm531zsOtzU53c3298/WjzsPn3z/79Zcff375w4vnzzbWv3n504v/Aa6Xu590aOKLAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Helipad crossing in wireframe mode"
        title="Helipad crossing in wireframe mode"
        src="/static/0d191572399573e488caeb1e1f171321/0a47e/wireframe_helipad.png"
        srcset="/static/0d191572399573e488caeb1e1f171321/8a4e8/wireframe_helipad.png 150w,
/static/0d191572399573e488caeb1e1f171321/5a46d/wireframe_helipad.png 300w,
/static/0d191572399573e488caeb1e1f171321/0a47e/wireframe_helipad.png 600w,
/static/0d191572399573e488caeb1e1f171321/27524/wireframe_helipad.png 646w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Apparently these special textures are not supposed to form crossings or curves. None of these special road types are actual "roads" (another example would be the "Caution" texture we talked about in <a href="/blog/roads-how-boring-part-3-building-a-graph-data-structure">part 3</a>).</p>
<p>To be honest, this seems more like a hack than anything else, but examining what happens when we do create a helipad crossing can give us some insights into the formulas we're trying to recreate:</p>
<ul>
<li>The rectangle for the crossing seems to be way too small, so it doesn't just linearly scale with <code>RoadWidthInTexture</code>.</li>
<li>The crossing rectangle contains a small part of the helipad texture, which confirms that this texture just isn't meant to be used for crossings. It can still help us to find the formula for the texture coordinates later, though!</li>
</ul>
<p>But first, without further ado, here are the rectangle sizes for all crossing types:</p>
<table>
<thead>
<tr>
<th>Crossing type</th>
<th>Width</th>
<th>Height</th>
</tr>
</thead>
<tbody>
<tr>
<td>T</td>
<td><code>RoadWidthInTexture + Stub + Overlap</code></td>
<td><code>RoadWidthInTexture + 2 * Stub + 2 * Overlap</code></td>
</tr>
<tr>
<td>X</td>
<td><code>RoadWidthInTexture + 2 * Stub + 2 * Overlap</code></td>
<td><code>RoadWidthInTexture + 2 * Stub + 2 * Overlap</code></td>
</tr>
<tr>
<td>Symmetric Y</td>
<td><code>1.59</code></td>
<td><code>1.065 + Overlap</code></td>
</tr>
<tr>
<td>Asymmetric Y</td>
<td><code>1.2 + RoadWidthInTexture / 2</code></td>
<td><code>1.33 + Overlap</code></td>
</tr>
</tbody>
</table>
<p><code>Stub</code> is the length of the little "arms" extruding from the T and X crossings and can be calculated with the formula <code>0.5 * (1 - RoadWidthInTexture)</code>. This is also the reason why the crossings are broken when <code>RoadWidthInTexture</code> becomes larger than 1.</p>
<p>All width and height values still need to be multiplied by <code>RoadWidth</code> to get the final result.</p>
<p>The formulas for T and X crossings make sense when you think about them, but the other two just contain magic numbers. Maybe they can be derived somehow...but we haven't found an explanation yet. Still, they appear to work, and that's good enough for now. :-)</p>
<h3>Rectangle offsets</h3>
<p>When we know the size of the rectangle, we can calculate the offset of the node position from the top left corner:</p>
<table>
<thead>
<tr>
<th>Crossing type</th>
<th>X</th>
<th>Y</th>
</tr>
</thead>
<tbody>
<tr>
<td>T</td>
<td><code>0.5 * RoadWidth</code></td>
<td><code>0.5 * Height</code></td>
</tr>
<tr>
<td>X</td>
<td><code>0.5 * Width</code></td>
<td><code>0.5 * Height</code></td>
</tr>
<tr>
<td>Symmetric Y</td>
<td><code>0.547 * RoadWidth</code></td>
<td><code>0.269 * Height</code></td>
</tr>
<tr>
<td>Asymmetric Y</td>
<td><code>0.5 * RoadWidth * RoadWidthInTexture</code></td>
<td><code>0.2 * Height</code></td>
</tr>
</tbody>
</table>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 512px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1da157f61d15aed7f18fa04587e9a228/01e7c/crossing_texture.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFbklEQVQ4yz1UaWxUVRQ+RmRRolFeI0iiAsWIGqNGrQYiwaoElIAWhu6zvH3fZ957M/Omy9DaUiiUliYmwHS6TUEQsEQU3KIJRn9h9Id/NGqmiUYJBGOZofaYNxhzc3Jvvvud9Z57ID8+SuTyeeLYSI6YKEwSYxMFYmyyQBw5NkKMjY8SU1PjROH4JHHug7PE+fNniFPvnSQKUyeIsYlJIj+aJ06cLBDnpt8lClOFqrHxiSpQDLOoGFYx2DXLLmpWvKiaVlEzA8woSqpa5GW5yElyUdTUW3eWXeFLml4UNa0o63qAzeh2fAZIjkeS5ZHiBaQFsSKMICAjiBhjWAyTFEZoBpsjUWyOxpBkuVs8XqjoRCgGwxSNFHfLBoiaUeZkpcyIUplXtLKkGWVJN8qippd5RS0zglRmJbksKGqZl5WypOllxTArUuGpWoUb6MmGVQZWkv+PJhZ450VkRAkDPPAY4IH3SkQcjwwvICfJyP7HqYgY2JAqGCT9TDKRTKUsx4nHPc9xUn5FUn4m4XlJx/O8lBscXDfpOG7S81KJdFt7wvGSt1ba95KptOclU57nZxxwUj4opgk16zeArBtgxR1QUj4MNLXAu69tht5QCDpJEtoaGmCwNQwfPlcDWVWHDoqGvi1bwacY2FMXgv0NTeC4HkC6vaPZ8/0h3Y7/GGO4pxsNE1oGBpYC4qJYLrcl6nlnQn37JkPZ7JTS1XWi9pPP1gHi4vDevZlmw7qw/cDAqfqUf47atz/f8M3Xy4AVpWtB7kEdFcM4vYHmABBvo6anX4yb1g8swyIfTyCraqirGtqud3494koqmbzIUDTSplWpK22YuGN4uBpEVf9V0vV5UdNnA8OxaGxXf10d8ENDkmKa2MzyN5tMu9Si6rOtLI+q62L9V5deoPzMVIxmMJr2Z1lemNuVabvx8tEjayDGsDMRksYIRVVeUjOMLzYgLgLEhWHLDkezWYxSDFLB67d3/LnLMF4IMuAybdMUTSNj2TdYnp9rdb0bm4eH14CoakVFN65ajvNluqMzta+3bxUgBmnfVd/RCRzLhDTbLimG+TvbEn6qb1NtcHcv25n9NChTq+tV2oxKOPjWsdwa2Nvf/9DBocPLAQBSrgfq0RzUvj/9QM3JU9ufvHDxjbUff1obmpw0ai5/ux4QVyy9evUJQKxq2t+/bXemzX2zp0er9zN24+Fh6rnZ0iLQbRuO5EYAEaFj6PCdDdkskIcOmWFRwsa0Pxtx3H9YRSsl+/ZJI9u2wfLvv1u6AHEZIC64D3HJ7YiLH0ZcAoh3YBCVZtmvawkHvFQanLT/im9Zz8QO9HMkL2A04d4UXRcZlkPFMPHtrm62x/fhkWvXHpG6u39kLRub9/fPco47Zx48+NubH114AGhB/I6VlQcpjgdKEEN0NBaiBgdJUpJRUNQSr6jzoqrNBUNENUzM9OyVVv3006OCHS+Fw9HKVyVJGjnHxXB+pBoERbvO8OI7oqoBI8k7WZLaTg4comKSjLwkl2lBnA/aKRgOlCCgbBhXNl7+9qVYW/sfra1hrEs4c1GanY9k95Qap6ZWQ2uU/CtCUsiJ4jpWUbcyFF3PDB6K0bKCgiD+zQniTZJlS8HIIi37WitFPVt15Uo1Z8dvhFvCGKPZeTJKYiyemN89NloNqmmN6na837Dte7WEs8nkhefpoSGF0TSMJlMYMc0gUqQE8XoLy9f0PfYErP75l8fptvZfo/EE7hwcKpFpf57v7r6y6fjxlRBqCAHDC2AlEtCbyy98tbcHdo2MvLg7u6enrv9AakdXl9/c2dmxPZfbGDT7PTMzKwDx7p2nz94fGs2v3frVpdWNhUJ182efrwz691+vyB2aoO5Q1wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Node positions in the crossing textures"
        title="Node positions in the crossing textures"
        src="/static/1da157f61d15aed7f18fa04587e9a228/01e7c/crossing_texture.png"
        srcset="/static/1da157f61d15aed7f18fa04587e9a228/8a4e8/crossing_texture.png 150w,
/static/1da157f61d15aed7f18fa04587e9a228/5a46d/crossing_texture.png 300w,
/static/1da157f61d15aed7f18fa04587e9a228/01e7c/crossing_texture.png 512w"
        sizes="(max-width: 512px) 100vw, 512px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p><a href="/blog/roads-how-boring-part-8-rendering-crossings-continued">Next time</a>, we'll solve the other two problems (figuring out the texture coordinates and calculating the start positions of the adjacent road segments A-M).</p></div></div><footer><div class="footer__content"><p>OpenSAGE is not associated with Electronic Arts or any other company. All trademarks are property of their respective owners. Screenshots of copyrighted works are only used for demonstration purposes.</p><p>© OpenSAGE <!-- -->2021</p></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/roads-how-boring-part-7-rendering-crossings";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4d452037006af707f98e.js"],"app":["/app-4c0eca78ab875c07fb76.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d44c0a818ce890b8c614.js"],"component---src-pages-blog-js":[],"component---src-pages-index-js":["/component---src-pages-index-js-b712fcc8262034a481fa.js"],"component---src-templates-post-js":["/component---src-templates-post-js-4e75ef5397eab02032db.js"]};/*]]>*/</script><script src="/polyfill-4d452037006af707f98e.js" nomodule=""></script><script src="/component---src-templates-post-js-4e75ef5397eab02032db.js" async=""></script><script src="/146795efe668deebd307e23d1bee48404d46676b-61b9cf2c73f895e6907b.js" async=""></script><script src="/app-4c0eca78ab875c07fb76.js" async=""></script><script src="/framework-3ff8eac72944ada5b1d3.js" async=""></script><script src="/webpack-runtime-da80e4af2c7a62b87dee.js" async=""></script></body></html>