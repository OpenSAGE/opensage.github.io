{"componentChunkName":"component---src-templates-post-js","path":"/blog/blender-w3d-plugin-2018","result":{"data":{"markdownRemark":{"html":"<p>As we've already announced in our latest post, we're working on a <strong>W3D Blender Plugin</strong>. We strongly believe that modding is a big part of SAGE being such a succesful engine over the years, which is why we want to contribute tools back to the community.</p>\n<p>You might already know that Westwood 3D (W3D) is the 3D format used in the first games created with the SAGE engine (later on replaced by an XML-based version called W3X). One big issue with the format used to be the lack of tools that allow authoring of these files. The official modding SDKs included plugins for Autodesk 3ds Max of the era - however, the issue is that Autodesk 3ds Max is a commercial tool and the official plugins are not compatible with modern versions of it. Apart from this it was lacking some features the community desperately needs, like the import of compressed animations.</p>\n<p>As the result of this we decided to write an open source Blender plugin, which adds support for exporting and importing of W3D files. Our existing W3D code from OpenSAGE was a big advantage, since it serves as the most comprehensive documentation available for the format.</p>\n<h1>Why Blender</h1>\n<p>With the latest major Blender 2.8 release it became the first choice for open source 3D modelling software. Big companies like Epic, NVIDIA, AMD and Ubisoft have decided to fund the development of Blender. Due to the open Python API it's also easy to write plugins that interact with the software.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f1dc5c62a5b13bc5a36517b17ac71b7c/a878e/blender_logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLUlEQVQY02N4VsPH8LyGl/llLQ/z0xq+rgfVgsYMSEAjvBVMq4a3MaiFtTOphbcxAtlMqmFtEHEgrRbezgjETGCBF7U8bECcBTR0+cc69iNf6llPfqpj82HQ/M8ZFJ/FCVIDVMzCgAUAxYWQ+arh7RxgxpMa/mqgIXfCE9In60c0bvjdwLA4Izl2kljwxAqgCyuBGicBXVIApNOBOBeIs4E4DYjnAnE10NVZQBqEtUDebQd6dc3netbD3nH5PdIhvUt/NjCuqc/wWyUQNKVLM7x1GdCre4CKNwDxfCAOB+KNqmHtvUB6BdCwg0DLFgPZtTAvO4BooMGFH+rYzwAN3ve6lnsBg/98NqBieZ2IJh6gYiC7XRjkdSBmBmJWIJYByvMBvckHZHMD2eAwBABRqnljPzn6RgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Blender Logo\"\n        title=\"Blender Logo\"\n        src=\"/static/f1dc5c62a5b13bc5a36517b17ac71b7c/0a47e/blender_logo.png\"\n        srcset=\"/static/f1dc5c62a5b13bc5a36517b17ac71b7c/8a4e8/blender_logo.png 150w,\n/static/f1dc5c62a5b13bc5a36517b17ac71b7c/5a46d/blender_logo.png 300w,\n/static/f1dc5c62a5b13bc5a36517b17ac71b7c/0a47e/blender_logo.png 600w,\n/static/f1dc5c62a5b13bc5a36517b17ac71b7c/1cfc2/blender_logo.png 900w,\n/static/f1dc5c62a5b13bc5a36517b17ac71b7c/c1b63/blender_logo.png 1200w,\n/static/f1dc5c62a5b13bc5a36517b17ac71b7c/a878e/blender_logo.png 2048w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1>How it works</h1>\n<p><em>This walkthrough assumes you know how Blender works and how to use it</em></p>\n<p>To start using the plugin you can download the latest version from our GitHub page, which can be found <a href=\"https://github.com/OpenSAGE/OpenSAGE.BlenderPlugin/releases\">here</a>. Through the preferences window you can select the zip archive to be installed. The import and export submenus now contain entries for the <code>*.w3d</code> format.\nDuring the import of a model it's important that all referenced files (skeleton &#x26; textures) can be found, so they must be in the same folder as the file you want to import.</p>\n<h2>General</h2>\n<p>Let's start by importing a simple structure, like the Gondor Barracks from Battle for Middle-earth:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d717a1828f92eaec3fa5c89a54d1fd88/29114/barracks.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByUlEQVQoz2VR227TQBDdj0FFvUCTYq/36sR20pKQoErgRjw1akIwde1CHxC8RShEiEuLItJSVSIK8IDy2C/s2U1TKnFkzc56zsycnSH7aZ6m+xYvXyyQJAnusN1ut9PpdO3xvJdkh6+yLEO8vbfX3m0TriNKXWDjFopAYR0G/gMLOI7jCCFc16GFtcLKnaW7S0QrJaRQUip4yhipVCUMhoP3B0kPbK1tAABHCod6ZWc1cJfvFwvEL/lSCmmhtPnQa2e7cTn7/WXQL2npMW4TLUFJz2MlWmQbK6v31oi8BS5EFJbzNHlz0Ds/HY2/fd59Ftcfbkn0V1IbTXBFEATa91HxXzKKM8ZqW5vn49Gnt/no5Ovk4mw6nbzOMwT0orngnDPWbDZbrdZ/nYPy8Yf+j4/9i7PTP9Off2ezozwF3Ra3HM4x3Xq9HscxEebBGJiZGcoz5tU2q+Px98n013A46L87ircbULRobNSFkQEGSTBrbcsqMR+JopQ+bjR2nj6BRMaoVFzZBoBJ9uijWi0MI9/3iXnDNazLGA5qcfNbSDbfCLbmUrdSqWBmkECwWW1X6Zej+VZBQlUwcDW51kIRpFarVbRHFE4YhldtC7m9Ql+P+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gondor Barracks\"\n        title=\"Gondor Barracks\"\n        src=\"/static/d717a1828f92eaec3fa5c89a54d1fd88/0a47e/barracks.png\"\n        srcset=\"/static/d717a1828f92eaec3fa5c89a54d1fd88/8a4e8/barracks.png 150w,\n/static/d717a1828f92eaec3fa5c89a54d1fd88/5a46d/barracks.png 300w,\n/static/d717a1828f92eaec3fa5c89a54d1fd88/0a47e/barracks.png 600w,\n/static/d717a1828f92eaec3fa5c89a54d1fd88/1cfc2/barracks.png 900w,\n/static/d717a1828f92eaec3fa5c89a54d1fd88/c1b63/barracks.png 1200w,\n/static/d717a1828f92eaec3fa5c89a54d1fd88/29114/barracks.png 1920w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>The model as you can see it in the screenshot above is in it's default state. As you can see in the scene collection on the right the plugin creates a parent collection for all meshes that are part of the <code>W3D</code> file. Since materials in Blender 2.8 are completely node-based, the plugin automatically creates a node based shader setup that matches the material specified in the model. See below for the barracks shader node setup, which uses a diffuse and a normal texture.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b6639b99cc5fdec9744910f7a85d147d/29114/barracks_nodes.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACW0lEQVQoz0WQC0/aUBiG+yuMolxKWwoYnEF2CVcBLWrmZbrp3CYBRESmEZaJumzLNGYhDiO0UGqrYGmMW1yEch/Csp+2o5jtyXe+5JyT5/1yDnQUjycSCTJJsiyXzwu5c57nhfhR4lv8OJWm6cwJlaJJik4kqf2D2NdY/Mve/urqqtfn83g8UKNer9cAoDdAlcoVsVSlM/TewYFw8YMXvp+dX7DZPMPljikmmWYj76MP9QMDOg2KoVD75qbVvPnVaFQrVVEsFYtFPs8HA+7wRoAXhNMsz57mGPYszXAUfZJhs9sfPo0RxPTU9AhBQPVapV6tlEtisXD98+qqcH29s7tFuEbfbb4NR0IpmsmccGQ6Q6aZZOq27378bLZYzVab3e6A/rRbv9vNVrPRqNVASFkULy8vuazAcHkyRYEv4M5y7GmWSpGH8b2CWI7FDmecjimHw2G3Qzvb0e1oNBIOR8Kb66FQaC0IFiAYWAkEAh6f1+PzLbndi4sLM9NP/X7/3LPZ+fGJhfGx4eFhyOUadRGjr16/dI25urq6JBJJd3ePVNpnfKRHlEqdQa/VauV9fZLeXqlU1t3To4Th26lOpx1MXva511aWNzaCk1MTCoUCQYCiVCIIrlajGPZ8/o3VbFFhGAzD4BgsDEVtVquzI3u9S1uRkNn0ZGhID2T4DhSBcUw1+GCIGJ/U9utkMtmteQfItVgs9/Lci9n1NT8x4jSaTHK5vDPBanw8OKBTqXD4HsU/wO1/GbzbZgNlMxgMarVao9GgKKrt7we9E4TcAbY4jqtAHo53ZCD+BbWd996mKewmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Gondor Barracks Shader\"\n        title=\"Gondor Barracks Shader\"\n        src=\"/static/b6639b99cc5fdec9744910f7a85d147d/0a47e/barracks_nodes.png\"\n        srcset=\"/static/b6639b99cc5fdec9744910f7a85d147d/8a4e8/barracks_nodes.png 150w,\n/static/b6639b99cc5fdec9744910f7a85d147d/5a46d/barracks_nodes.png 300w,\n/static/b6639b99cc5fdec9744910f7a85d147d/0a47e/barracks_nodes.png 600w,\n/static/b6639b99cc5fdec9744910f7a85d147d/1cfc2/barracks_nodes.png 900w,\n/static/b6639b99cc5fdec9744910f7a85d147d/c1b63/barracks_nodes.png 1200w,\n/static/b6639b99cc5fdec9744910f7a85d147d/29114/barracks_nodes.png 1920w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Since there are many material options which are specific to <code>W3D</code>, we added two new property groups to the material section of each object. These groups are required to set advanced options of the Westwood3D format, which are quite specific to the SAGE game engine. So these options are only used for the exported file and have no effect in Blender itself.</p>\n<h2>Skinned models</h2>\n<p>Let's continue by importing a simple skinned model, like the Cave Troll from Battle for Middle-earth:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/04e29772c069daf7e7c2fd0808f91fbc/29114/cave_troll.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABRUlEQVQoz2VS226DMAzlb7ZJgw1N4pYE58KAXtA0TXvo09o9tFNp2qn//7BDgIm2J1ZkbB/7WMRr7a89HNq2tdbuJzi44G7EFudnfzqd7fGIz83me/219oQqheCMsWyCJEmB7BKccUkqTePoJQyegvuHO08ioJU2zpQGlFLLxaysSq2NdjDOEIefMfYcBGEY+r7vIdDxlVS6M/izurLb1Xn3OZ/XksiAJAfAhUb/cYAnJyCiZTOvZ1WzrFYfxfvbAj3lJfKcFk1TGINi7yoHdYgiV9eQTTdcKbgoX8uiKKDimoxiPajodbpdJro55+hujLkg97SbSWOL3qTsyFIOZOrVKmmUutr/pgf+C2Qz7D2SiVROlOcCZ4R0vakL5/+3k6CzLMXwkawKpIQQjHG8BDjcAaVJkkRRFMcxbryZ3A3sa+Cg4A/MV61BhUYhDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Cave Troll\"\n        title=\"Cave Troll\"\n        src=\"/static/04e29772c069daf7e7c2fd0808f91fbc/0a47e/cave_troll.png\"\n        srcset=\"/static/04e29772c069daf7e7c2fd0808f91fbc/8a4e8/cave_troll.png 150w,\n/static/04e29772c069daf7e7c2fd0808f91fbc/5a46d/cave_troll.png 300w,\n/static/04e29772c069daf7e7c2fd0808f91fbc/0a47e/cave_troll.png 600w,\n/static/04e29772c069daf7e7c2fd0808f91fbc/1cfc2/cave_troll.png 900w,\n/static/04e29772c069daf7e7c2fd0808f91fbc/c1b63/cave_troll.png 1200w,\n/static/04e29772c069daf7e7c2fd0808f91fbc/29114/cave_troll.png 1920w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>So let's take a closer look at what happened here. During import the skeleton is automatically loaded and applied to the mesh (in the scene collection it's named <code>MUCAVTROLL_SKL</code>). The pose that you can now see is the so called <strong>rest pose</strong>, which means no animation is applied to the hierarchy.</p>\n<h2>Animation</h2>\n<p>If we want to add an animation we need to load the separate animation file, e.g. the attack animation (<code>mucavtroll_atkg.w3d</code>). The animation is automatically applied to the base model of the troll. Unfortunately there is a keyframe created for each frame in most cases due to the animation compression technique used in W3D.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 600px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3fe2f29945c6bb5f5a00799b3758f3b1/29114/cave_troll_attack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABuklEQVQoz01S23LTMBD17/BCEluSrcqydbMs36Ad2j4k3DKQOkAThg8o386RzTDsyOv1SmfP2ZWT09cv5/N5np++Lfbj+flyvVyvl/VzxsZfO83n75efv7A7P52Ox+PnTx+TvCiMMdvtNsuyNE3hhciFYJwXspI30QQeHt9CKc05JyxPCXv1Ok2AvL29e3d/Pw5jngMmkLHOwo9jH1r/9s3QNI21MYesrGptfKVdlouEMXY4vH95+f3w8EgIAQHKG6O1VsPYHw93Hx57VauYWKyqIEi2rR/6PgFb14VhGJRSRVFAlaprBahSfQhd65xVa62YA1hKRuk0Tfv9PgEV8OAHMvYGsFIG5ErHKtFWyphClVKWYPC+CSEk6yT+TYXfcKu1XY6b/0wvvAikLLsQnHNVVSUFoznNeJHzgq8SRFliYTBwpUAIJ6IAVUMzBHrv67qGxqSsLeNVmhFGibcKq4F3dRuCdyZmnLJaEsoIpbjIzWYDFZh/ZFbGdcMIQkIoxjZNcD0miWEhGIf4GUKLX2C72+3SFGBowc2hhQRC03S3NB4VSikRoKprPHJ8sTwvKKXrAdBgF2A08gdkQKyTjQOUSgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Cave Troll\"\n        title=\"Cave Troll\"\n        src=\"/static/3fe2f29945c6bb5f5a00799b3758f3b1/0a47e/cave_troll_attack.png\"\n        srcset=\"/static/3fe2f29945c6bb5f5a00799b3758f3b1/8a4e8/cave_troll_attack.png 150w,\n/static/3fe2f29945c6bb5f5a00799b3758f3b1/5a46d/cave_troll_attack.png 300w,\n/static/3fe2f29945c6bb5f5a00799b3758f3b1/0a47e/cave_troll_attack.png 600w,\n/static/3fe2f29945c6bb5f5a00799b3758f3b1/1cfc2/cave_troll_attack.png 900w,\n/static/3fe2f29945c6bb5f5a00799b3758f3b1/c1b63/cave_troll_attack.png 1200w,\n/static/3fe2f29945c6bb5f5a00799b3758f3b1/29114/cave_troll_attack.png 1920w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Export</h2>\n<p>Exporting W3D models is a tricky, because meshes, skeletons and animations should get split in separate files. During the export the user must configure the export options accordingly.</p>\n<h2>Render</h2>\n<p>Another cool usage of Blender is of course that it includes great rendering capabilities, so this plugin could also be used for this purpose.</p>\n<div class=\"video-responsive\">\n    <iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/qazn4JlNm3Q\" frameborder=\"0\" gesture=\"media\" allow=\"encrypted-media\" allowfullscreen></iframe>\n</div>\n<p>We are happy to hear your feedback about the new Blender W3D plugin!</p>","frontmatter":{"slug":"blender-w3d-plugin-2018","title":"An open-source Blender W3D plugin","summary":"A new plugin enables the import & export of W3D files into Blender","author":"Stephan Vedder","date":"2019-11-23"}}},"pageContext":{"slug":"blender-w3d-plugin-2018"}}}